---
pagetitle: "ETX2250/ETF5922"
subtitle: "Data Visualisations in Power BI"
author: Kate Saunders
email: "etx2250-etf5922.caulfield-x@monash.edu"
date: "Lecture 3"
department: "Department of Econometrics and Business Statistics"
unit-url: "dvac.ss.numbat.space"
footer: "ETX2250/ETF5922"
format: 
  revealjs: 
    logo: images/monash-one-line-black-rgb.png
    slide-number: c
    multiplex: false
    theme: ../assets/monash.scss
    show-slide-number: all
    show-notes: false
    controls: true
    width: 1280
    height: 720
    css: [../assets/custom.css, ../assets/lecture-01.css]
    include-after-body: "../assets/after-body.html"
    #   boardmarker-width: 5
    #   buttons: true
    embed-resources: true
---

```{r}
library(tidyverse)
```

## <br>[`r rmarkdown::metadata$pagetitle`]{.monash-blue} {#etc5523-title background-image="images/bg-01.png"}

### `r rmarkdown::metadata$subtitle`

Lecturer: *`r rmarkdown::metadata$author`*

`r rmarkdown::metadata$department`

::: tl
<br>

<ul class="fa-ul">

<li><i class="fas fa-envelope"></i>`r rmarkdown::metadata$email`</li>

<li><i class="fas fa-calendar-alt"></i> `r rmarkdown::metadata$date`</li>

<li><i class="fa-solid fa-globe"></i>\<a href="`r rmarkdown::metadata[["unit-url"]]`"\>`r rmarkdown::metadata[["unit-url"]]`</a></li>

</ul>

<br>
:::

## Learning Objectives

:::: callout-note
## Learning Objectives

::: incremental
-   Understand the importance of data visualisation

-   Become familiar with Power BI's visualisation capabilities

-   Learn how to use Power BI's visualisation pane

-   Learn best practices for effective data visualisation
:::
::::

# Power BI {background-color="#006DAE"}

## What is Power BI?

:::: callout-note
## What is Power BI?

It is a common tool used by business analysts.

Does the standard stuff:

::: incremental
-   **Data Integration**: Importing data and connecting to multiple data sources (Excel, databases, cloud services).
-   **Data Transformation**: Can use Power Query to clean and transform data.
-   **Data Visualisation**: Create charts, graphs, and maps (also interactive features).
-   **Collaboration and Sharing**: Publish reports and dashboards for sharing with others.
:::
::::

## Why Use Power BI?

:::: callout-note
## What are the key advantages?

::: incremental
-   **Ease of Use**: Drag-and-drop interface suitable for beginners.
-   **Employers Use It**: Very common tool for visualisation in business analytics.
-   **Reporting**: It's highly useful for automatic and repeated reporting.
-   **Real-Time Analytics**: Allows real-time data updates for timely insights.
:::
::::

## Other choices

:::: callout-note
## There are many options for business analysts

Data visualisation tools (not particular order):

::: incremental
-   [Excel](https://www.microsoft.com/en-au/microsoft-365/excel)
-   [Tableau](https://www.tableau.com/)
-   [Looker](https://cloud.google.com/looker/)
-   [Domo](https://www.domo.com/business-intelligence/visualizations-and-dashboards)
-   [SAP Analytics Clouds](https://www.sap.com/australia/products/technology-platform/cloud-analytics.html)
-   [Coding langauges: R and Phython](https://www.data-to-viz.com/)

And many more ...

We can't teach them all, so we aim to give you transferable foundations.
:::
::::

## Power BI vs R

::::::: columns
:::: {.column width="50%"}
::: callout-note
### Power BI

Power BI is ideal for day-to-day business reporting.

**Pros:**

-   User-friendly (no programming)
-   Easy to create dashboards
-   Real-time capabilities, and
-   Straightforward sharing

**Cons:**

-   Limited Customisation
-   Cost
:::
::::

:::: {.column width="50%"}
::: callout-note
### R

R is great for data scientists and analysts who need in-depth control over visualisations.

**Pros:**

-   Highly customisable
-   Suitable for advanced analytics
-   Open source (aka. free)
-   Automation / reproducibility (more than plug and play)

**Cons:**

-   Higher hurdle to entry - need to code.
-   Simple tasks don't need customisation
:::
::::
:::::::

## Power BI and R

:::: callout-important
::: incremental
-   If you master data visualisation in both Power BI and R, you'll have a diverse skillset.

-   We exposure you to these tools, so you can see the full spectrum of data visualisation tools used in business analytics.

-   We know R is harder, but its is important to challenge yourselves!
:::
::::

## Let's look at some examples

:::: callout-note
## Industry Applications of Power BI

There are many, many examples!

<br>

::: incremental
-   [Tourism Australia](https://www.tourism.australia.com/en/insights/tourism-statistics/aviation-statistics.html) *Which country has the most flights each week into Melbourne Airport?* [NZ]{style="color:white;"}

-   [Vic Health](https://www.health.vic.gov.au/infectious-diseases/local-government-areas-surveillance-report) *What was the most common infection in the Local Government area of Monash?* [Influenza]{style="color:white;"}

-   [Recycling Victoria](https://www.vic.gov.au/victorian-local-government-waste-data-dashboard) *How many tonnes of paper were collected from Monash City Council in 2022?* [52% 5860t]{style="color:white;"}
:::
::::

Notice these examples show mostly simple visualisations (e.g. map, line plot, bar charts) linked with tables. This is where Power BI excels.

## Your turn

::: callout-note
## Your turn

-   Take some time to explore these dashboards

-   Consider the ease of use and functionality

-   Form an opinion on whether these are good or bad plots

    -   *Think about graphical principles, visual hierarchy, gestalt principles etc*

-   Try answering my questions from the previous slide
:::

# Getting Started {background-color="#006DAE"}

## Installation

::: callout-important
Please see the Moodle for a guide about how to install Power BI on your laptop!

**You should have completed this before class in your own time.**
:::

# Live Demo {background-color="#006DAE"}

## Live Demo

::: callout-note
## Walkthrough:

Introduce key components of the Power BI interface:

-   The Canvas
-   Fields pane
-   Visualisations pane
-   Filters pane, and
-   Report View.
-   Show you how to import data
-   Show you how to create a basic bar chart
-   Show you how to polish that visualisation
:::

## Example

![](images/lecture-03/bar.png){fig-align="center"}

## Polishing you visualisation

When you are happy with the plot you've chosen for your data it is time to polish the plot.

::: callout-note
### Steps

-   Update all the plot labels
    -   Title, axes labels, tick labels, legend text etc.
    -   Use intuitive and intelligent labels
    -   You must include units where relevant
    -   Ensure the text size is readable!
:::

## Polishing you visualisation

::: callout-note
### Steps

-   Chose an appropriate colour scale

-   Align your visual elements in your plot for clarity

    -   e.g. Think about legend position

-   Check the final plot conveys the message you intend

    -   Be sure your plot proportions are good
    -   Check the range on your axes

-   May like to add additional text or colour to draw the eye to important parts of the plot you want to highlight
:::

## Your turn

::: callout-note
## Your turn

-   Import the same data as me!

-   Try recreating the same plot in Power BI
:::

# In Built Visualisations {background-color="#006DAE"}

## Close Up: Visualisation Pane

:::::: columns
::: {.column width="30%"}
![](images/lecture-03/visual-pane.png){fig-align="center"}
:::

:::: {.column width="70%"}
::: callout-note
### What it does

-   Core interface for building visuals in Power BI.\
-   Drag-and-drop fields into *Axis*, *Values*, *Legend*, etc.\
-   Default visuals include bar/line charts, tables, maps, pies, treemaps.\
-   Supports custom visuals and R/Python integrations.
:::
::::
::::::

## Barplots

::: callout-note
## When to use

-   When working with numeric and categorical data

-   Great for comparing differences between categories directly
:::

. . .

::: callout-caution
## What to watch out for

-   Not the same as histograms

-   Too many categories create clutter

-   Bars should not be in a random order - Order bars for comparability

-   For readability use horizontal bars

-   Avoid 3D effects
:::

## Pie Example - okayish

![](images/lecture-03/pie.png){fig-align="center"}

-   Note the percentages are the percentages related to the top 5 countries as we filtered our data.

## Doughnut Example

![](images/lecture-03/donut.png){fig-align="center"}

-   Note the percentages are the percentages related to the top 5 countries as we filtered our data.

## Awful Pie Example

![](images/lecture-03/bad_pie.png){fig-align="center"}

## Pie and Doughnut Plots

::: callout-note
## When to use

-   Show proportions of a whole

-   Suitable for small numbers of categories

-   Works best when highlighting a very big or very small segment

-   Doughnut plots are the same as pies (but with holes)
:::

## Pie and Doughnut Plots

::: callout-caution
## What to watch out for

-   Humans read angles poorly!

-   Make sure the proportions add up to a whole

-   Labeling wedges directly can be more effective than using a legend

-   Too many slices or similar colours reduce clarity

-   Doughnuts have same drawbacks as pies
:::

## Treemap Example

![](images/lecture-03/treemap.png){fig-align="center"}

## Treemap

::: callout-note
## When to Use

-   Good for categorical and numeric data

-   Efficient when ther are many categories

-   Also efficient for data with nested structures (hierarchies)

-   Rectangle area encodes value; colour can encode a second variable
:::

. . .

::: callout-caution
## Watch out for

-   Limit to \~2â€“3 hierarchy levels for readability

-   Very small categories become unreadable

-   Interactivity can help when many levels are needed
:::

## Your turn

::: callout-note
## Your turn

-   Try recreating some of these plot types

-   What do you notice about the plots

-   Which ones work best for the data and understanding the key messages?
:::

. . .

::: callout-important
## Concept Check

When you would rather a bar chart, a pie chart or a tree map for visualising data?
:::

# Barplots of Multiple Variables {background-color="#006DAE"}

## Types of Barplots

::: callout-note
## About

-   Bar plots can can have a primary and secondary categorical variable.

-   The primary categorical variable can be split into secondary sub-levels. *e.g. 1. Country of Birth and 2. Gender*

-   Three different types of bar plots

    -   Stacked

    -   Clustered (grouped), and

    -   Percentage stacked
:::

## Stacked Barplot Example

Good for comparing the total number of residents.

![](images/lecture-03/stacked.png){fig-align="center"}

## Stacked Barplots

::: callout-note
## When to use

-   When comparing totals in the primary category is the most important

-   The composition of secondary levels is also relevant, but less important
:::

::: callout-caution
## Watch out for

-   As the bars are stacked, it is difficult to compare the secondary categories across bars
:::

## Clustered (Grouped) Barplot Example

Use to compare differences in the number of residents between census years and for each country.

![](images/lecture-03/clustered.png){fig-align="center"}

## Clustered (Grouped) Barplots

::: callout-note
-   Compare secondary categories *within* each primary group.

-   Also compare primary categories *across* secondary groups
:::

. . .

::: callout-caution
-   Not suitable for comparing totals

-   Can get cluttered with many sub-categories
:::

## Percentage Stacked Barplots

Shows the percentage by of residents from each census.

![](images/lecture-03/percent.png){fig-align="center"}

## Percentage Stacked Barplots

::: callout-note
## When to use

-   When interested in proportions within the total

-   Each bar scaled to 100%

-   A variation of stacked bar plots, but better for comparing relative distributions of the secondary groups.
:::

. . .

::: callout-caution
## Watch out for

-   No longer comparing the total of the primary category
:::

## Small Multiples Example

![](images/lecture-03/small_multiples.png){fig-align="center"}

## Small Multiples

:::: callout-note
### About

::: incremental
-   Also known as faceted charts.

-   Used to display multiple visualisations (or "panels") of the same chart type

-   Each panel represents a subset of data based on a specific category

-   Excellent for spotting patterns across categories

-   Useful when you have a large amount of data - improves data-density
:::
::::

. . .

::: callout-caution
## Watch out for

-   Keep axis scales consistent (when appropriate)
-   Maintain consistent colours, labels, and design
:::

## Your turn

::: callout-note
## Your turn

-   Try these different types yourself
:::

. . .

::: callout-important
## Concept Check

-   When you would rather each of these different types? It all has to do with the comparison you want to make!

-   Also important to consider which is the primary and secondary variable when designing bar charts / small multiples
:::

# Other Plots {background-color="#006DAE"}

## Other Plots

:::: callout-note
### About

Other commonly used plot types are

::: incremental
-   Line charts

-   Area charts

-   Scatter plots

-   Bubble charts

-   Ribbon charts

-   Waterfall charts

-   so on
:::
::::

## Map Example

![](images/lecture-03/map.png){fig-align="center"}

## Maps

::: callout-note
## When to Use

-   Visualise geospatial data (lat/long or regions)

Once the map is drawn, we can:

-   colour each region (choropleth map)

-   add points or bubbles (bubble map)

-   reshape the region (cartogram)

-   show the connection between several regions (connection map)
:::

. . .

::: callout-caution
## Watch out for

-   Projection matters for correct areas/distances
:::

## What's missing?

:::: callout-note
Many common plots that are not in the default visualisation pane:

::: incremental
-   Boxplots

-   Histograms

-   Density plots

-   Contour plots

-   Heatmaps

-   so on
:::

We'll show you how to create some of these in R
::::

## Customisation

:::: callout-note
### About

::: incremental
-   Custom visuals are particularly useful when we need a unique visualisation that is not available in the standard Power BI visual library.

-   We can create custom visuals using R, Python, JavaScript and TypeScript.

-   To create a custom visual in Power BI, we need the Power BI Visuals Tools (pbiviz), which provides a framework for building, testing, and packaging custom visuals.

-   After creating the custom visual, you can import it into your Power BI reports.

:::
::::

# Summary {background-color="#006DAE"}

## Summary

:::: callout-note
### What we have covered

::: incremental
-   An overview of visualisation in Power BI

-   Covered many of the standard types of visualisations

    -   Specifically numeric and categorical

    -   Bars, Pies, Dougnuts, Treemaps

    -   Stacked, Clustered, and Percent Stacked Bar plots

-   Discussed more about how to choose the right visualisation for the data and the relationships when want to compare
:::
::::
